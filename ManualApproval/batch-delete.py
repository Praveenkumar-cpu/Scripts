import requests
import json

import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

PAGE_SIZE = 100
BASE_URL = "https://polar.creditsaison.in/api/v1"
AUTH = "Basic VW41R3lPdm5TYkV3OVRmOmVPazBjM1o4N1dta3VqVg=="


def fetch(pageNumber):
    url = BASE_URL + "/failureEvents?pageNumber=" + str(pageNumber) + "&pageSize=" + str(PAGE_SIZE)
    headers = {
    'Content-Type': 'application/json',
    'Authorization': AUTH
    }

    response = requests.request("GET", url, headers=headers, data={}, verify=False)

    return response.json()

def delete(resourceId, payload):
    url = BASE_URL + "/event/v2/" + resourceId

    payload = json.dumps(payload)
    headers = {
    'Content-Type': 'application/json',
    'Authorization': AUTH
    }

    response = requests.request("DELETE", url, headers=headers, data=payload, verify=False)

    print(resourceId, response.status_code)


failureEvents = []

pageNumber = 1

resp = fetch(pageNumber)
events = resp.get('events')
failureEvents.extend(events)
total  = resp.get('total')
fetched = len(events)

while (fetched < total):
    pageNumber += 1
    resp = fetch(pageNumber)
    events = resp.get('events')
    failureEvents.extend(events)
    total  = resp.get('total')
    fetched += len(events)

# items to deleted add in list
resourceIds = [
"BPL2802257484294",
"BPL2802257484323",
"BPL2802257484326",
"BPL2101257337937",
"BPL2802257485213",
"BPL2301257345968",
"BPL2802257485876",
"BPL0402257385998",
"BPL2802257484038",
"BPL2301257345968",
"BPL2212247226257",
"BPL2301257346003",
"BPL2301257346003",
"BPL1002257411319",
"BPL1002257410720",
"BPL2802257484076",
"BPL1002257410720",
"BPL2802257484069",
"BPL3001257369424",
"BPL1002257411276",
"BPL3001257369424",
"BPL1002257410789",
"BPL1002257410789",
"BPL1002257411319",
"BPL2602257478547",
"BPL3012247254487",
"BPL2702257480832",
"BPL2802257484073",
"BPL2602257478547",
"BPL2502257474337",
"BPL3012247254487",
"BPL2802257484097",
"BPL2802257485876",
"BPL2802257485213",
"BPL0103257486770",
"BPL0103257486522",
"BPL0602257395452",
"BPL1002257411276",
"BPL0103257487944",
"BPL0103257487944",
"BPL2802257484108",
"BPL2802257484107",
"BPL0602257395681",
"BPL2702257480832",
"BPL1801257327857",
"BPL1801257327857",
"BPL1301257308066",
"BPL1002257411306",
"BPL1002257411306",
"BPL0602257395489",
"BPL2802257485249",
"BPL2702257481167",
"BPL2802257484130",
"BPL2802257485249",
"BPL2802257484092",
"BPL2802257484129",
"BPL2702257480956",
"BPL2301257347887",
"BPL2401257348953",
"BPL2702257480956",
"BPL2802257484126",
"BPL0802257401233",
"BPL0802257401233",
"BPL2802257484130",
"BPL0802257401253",
"BPL0201257263173",
"BPL2802257483675",
"BPL2802257484340",
"BPL0203257493919",
"BPL0201257263173",
"BPL1301257308066",
"BPL1301257308145",
"BPL2702257481129",
"BPL2802257484138",
"BPL2702257480198",
"BPL2702257481129",
"BPL2801257362283",
"BPL2802257484152",
"BPL0602257395681",
"BPL2802257484168",
"BPL2802257484334",
"BPL2802257484203",
"BPL2802257484181",
"BPL2602257478320",
"BPL2802257484214",
"BPL1002257410927",
"BPL2802257484256",
"BPL0302257381512",
"BPL0302257381512",
"BPL0602257395781",
"BPL0802257401970",
"BPL1202257419380",
"BPL3001257368424",
"BPL2802257484191",
"BPL2802257484342",
"BPL1002257411131",
"BPL0402257385998",
"BPL0602257395781",
"BPL2702257481167",
"BPL0402257386177",
"BPL2802257484225",
"BPL2802257484225",
"BPL2802257484350",
"BPL0402257386697",
"BPL0802257401310",
"BPL1202257419380",
"BPL2702257481341",
"BPL2702257481341",
"BPL2802257484291",
"BPL0902257405832",
"BPL1002257410555",
"BPL0802257401310",
"BPL0602257395175",
"BPL0103257486770",
"BPL0103257486522",
"BPL2802257485357",
"BPL2802257484403",
"BPL2702257481358",
"BPL0902257406030",
"BPL1002257410555",
"BPL2702257481358",
"BPL1002257407751",
"BPL1002257407751",
"BPL0302257382231",
"BPL0602257395175",
"BPL2401257350223",
"BPL0402257386139",
"BPL0703257512182",
"BPL0402257386139",
"BPL2401257350223",
"BPL0801257286930",
"BPL0801257286930",
"BPL0802257401890",
"BPL0702257396895",
"BPL2602257475847",
"BPL2602257475847",
"BPL2602257476400",
"BPL2702257481534",
"BPL2801257362283",
"BPL2702257481534",
"BPL2802257485329",
"BPL0702257396895",
"BPL0802257401466",
"BPL0202257378454",
"BPL0702257397772",
"BPL0802257401466",
"BPL0602257394622",
"BPL0602257394622",
"BPL1301257308145",
"BPL0902257405744",
"BPL0402257386177",
"BPL2802257484261",
"BPL0702257397835",
"BPL0902257405815",
"BPL2412247234050",
"BPL2702257481606",
"BPL0103257487428",
"BPL0103257487428",
"BPL0902257405744",
"BPL0902257405832",
"BPL2702257481606",
"BPL2802257484364",
"BPL2802257484253",
"BPL0702257396531",
"BPL0702257396531",
"BPL0103257487562",
"BPL2802257484417",
"BPL2602257478245",
"BPL2602257478245",
"BPL1801257328024",
"BPL1801257328024",
"BPL0702257396558",
"BPL2801257362637",
"BPL2802257484415",
"BPL0702257396558",
"BPL2801257362637",
"BPL2602257476772",
"BPL2602257476772",
"BPL2802257484371",
"BPL2412247234050",
"BPL2602257477216",
"BPL2602257477316",
"BPL2602257477316",
"BPL1002257409683",
"BPL2501257352595",
"BPL2501257352595",
"BPL0902257405815",
"BPL1002257407496",
"BPL0402257386697",
"BPL2602257477270",
"BPL0502257388988",
"BPL2602257478256",
"BPL2802257484289",
"BPL1002257408382",
"BPL1002257408382",
"BPL2802257484425",
"BPL2802257484281",
"BPL0703257511794",
"BPL0103257488680",
"BPL2802257484282",
"BPL0703257511794",
"BPL0802257402771",
"BPL0802257402771",
"BPL0502257391286",
"BPL0502257391286",
"BPL0302257382231",
"BPL2602257477270",
"BPL2802257484443",
"BPL2802257484442",
"BPL2802257485467",
"BPL2802257485467",
"BPL0202257379842",
"BPL0202257379842",
"BPL0702257398784",
"BPL2602257477216",
"BPL2602257477396",
"BPL2602257477498",
"BPL2602257477498",
"BPL0703257511771",
"BPL2802257484474",
"BPL0802257402352",
"BPL0802257402352",
"BPL2802257484449",
"BPL2802257484375",
"BPL0102257376161",
"BPL2501257351775",
"BPL2802257484488",
"BPL2802257484421",
"BPL0102257376161",
"BPL0402257387478",
"BPL0402257387478",
"BPL0503257504293",
"BPL2802257484500",
"BPL2602257477396",
"BPL2802257485722",
"BPL0702257398419",
"BPL2802257484626",
"BPL2802257484618",
"BPL2802257484618",
"BPL2802257485624",
"BPL2501257351775",
"BPL2602257478256",
"BPL0703257511771",
"BPL1401257312430",
"BPL1401257312430",
"BPL0702257398419",
"BPL2802257485624",
"BPL1002257407496",
"BPL0303257494245",
"BPL1002257407858",
"BPL1002257408183",
"BPL1201257305302",
"BPL1201257305302",
"BPL2802257485898",
"BPL2802257485898",
"BPL1102257413780",
"BPL2802257486040",
"BPL2802257486040",
"BPL0502257390134",
"BPL1102257413780",
"BPL1002257410751",
"BPL2602257478235",
"BPL2602257478235",
"BPL2702257478935",
"BPL0502257390110",
"BPL1201257304035",
"BPL0502257390110",
"BPL2212247226257",
"BPL2802257485722",
"BPL2802257484876",
"BPL2802257484876",
"BPL0402257384873",
"BPL0502257390134",
"BPL1201257304035",
"BPL0703257511626",
"BPL2702257478713",
"BPL0402257386237",
"BPL2702257479413",
"BPL0502257388988",
"BPL0402257386237",
"BPL2702257478903",
"BPL2702257478903",
"BPL2702257478995",
"BPL1002257407757",
"BPL2702257478995",
"BPL0602257393062",
"BPL0602257393062",
"BPL2702257478713",
"BPL0602257392060",
"BPL0602257392060",
"BPL2702257478935",
"BPL0602257393225",
"BPL0602257393225",
"BPL2702257479146",
"BPL2702257479146",
"BPL0402257384873",
"BPL1002257408028",
"BPL2802257485115",
"BPL2802257485115",
"BPL2702257479413",
"BPL0103257490274",
"BPL0602257393505",
"BPL1102257415853",
"BPL1102257415853",
"BPL0602257393505",
"BPL0103257488532",
"BPL0103257488635",
"BPL1002257408889",
"BPL1002257408889",
"BPL0103257490369",
"BPL0502257391752",
"BPL0502257391752",
"BPL0703257511626",
"BPL2602257478399",
"BPL2602257478399",
"BPL0103257489147",
"BPL0802257400011",
"BPL2802257485364",
"BPL2802257485364",
"BPL2702257479045",
"BPL0902257406030",
"BPL0802257400011",
"BPL0602257394302",
"BPL0602257394302",
"BPL0103257490886",
"BPL1002257408183",
"BPL0703257512020",
"BPL2802257485172",
"BPL0203257492100",
"BPL0203257492100",
"BPL0203257492122",
"BPL0802257400276",
"BPL0802257400276",
"BPL2702257480225",
"BPL0103257488425",
"BPL0103257488425",
"BPL0103257490886",
"BPL0203257492122",
"BPL0703257512020",
"BPL0802257400489",
"BPL2702257479045",
"BPL0203257493194",
"BPL0502257391180",
"BPL0502257391180",
"BPL0802257400489",
"BPL0402257386633",
"BPL0402257386633",
"BPL0702257398847",
"BPL0802257400693",
"BPL0802257400693",
"BPL0802257400829",
"BPL2702257480094",
"BPL0802257401067",
"BPL0802257401067",
"BPL0103257488635",
"BPL0203257491646",
"BPL0203257491178",
"BPL0203257491178",
"BPL0203257493194",
"BPL0103257488532",
"BPL0203257493568",
"BPL0703257512182",
"BPL0103257488680",
"BPL2802257484019",
"BPL0203257491238",
"BPL0203257492495",
"BPL0103257491048",
"BPL0103257491048",
"BPL1102257415821",
"BPL1102257415821",
"BPL2802257483961",
"BPL0703257512444",
"BPL0103257488738",
"BPL2802257483923",
"BPL0203257493581",
"BPL0203257493581",
"BPL2702257479960",
"BPL2702257479960",
"BPL0103257488830",
"BPL0203257491238",
"BPL0203257491646",
"BPL0203257493618",
"BPL2702257480236",
"BPL2702257480236",
"BPL2802257483948",
"BPL0203257491777",
"BPL0203257491777",
"BPL0203257492495",
"BPL2702257480094",
"BPL2802257485602",
"BPL2802257485602",
"BPL0103257489981",
"BPL0103257489981",
"BPL0103257489147",
"BPL0103257489744",
"BPL0103257490369",
"BPL2802257483726",
"BPL0203257493618",
"BPL0203257493679",
"BPL0203257493679",
"BPL2702257480225",
"BPL2802257483726",
"BPL2802257483729",
"BPL0303257497042",
"BPL0703257512444",
"BPL0103257489357",
"BPL0103257489357",
"BPL0103257490139",
"BPL0103257490139",
"BPL2702257480302",
"BPL2802257483729",
"BPL2802257483942",
"BPL0103257489455",
"BPL0103257489744",
"BPL0203257491151",
"BPL2702257480302",
"BPL0103257486274",
"BPL2802257484282",
"BPL0103257489197",
"BPL2802257485357",
"BPL2602257477391",
"BPL2602257477391",
"BPL0103257489197",
"BPL0103257490274",
"BPL0203257491180",
"BPL0203257491291",
"BPL0103257487591",
"BPL0103257487591",
"BPL0103257487562",
"BPL0103257489718",
"BPL0503257505925",
"BPL0203257491180",
"BPL0203257493463",
"BPL0203257493743",
"BPL0103257488437",
"BPL0203257493004",
"BPL0203257493748",
"BPL0203257493748",
"BPL0203257493902",
"BPL0203257493902",
"BPL0303257494245",
"BPL2802257484900",
"BPL2802257484900",
"BPL0103257489718",
"BPL0602257392239",
"BPL0602257392239",
"BPL0203257493568",
"BPL0203257493743",
"BPL1002257409683",
"BPL0103257489455",
"BPL2702257480529",
"BPL2802257484033",
"BPL0203257491291",
"BPL0203257492239",
"BPL0203257492239",
"BPL2802257484061",
"BPL0303257494607",
"BPL0303257494607",
"BPL0303257497042",
"BPL2702257480529",
"BPL0503257506004",
"BPL0503257506004",
"BPL0303257494810",
"BPL0503257505366",
"BPL0503257505366",
"BPL0503257506483",
"BPL0303257494810",
"BPL0303257497301",
"BPL0303257497301",
"BPL0503257506483",
"BPL0203257493636",
"BPL0303257497465",
"BPL0303257497465",
"BPL0303257497638",
"BPL0303257497638",
"BPL0203257493636",
"BPL0303257495635",
"BPL0303257495635",
"BPL0303257495569",
"BPL0303257495569",
"BPL0303257495994",
"BPL0303257494661",
"BPL0303257494661",
"BPL0103257489782",
"BPL0303257495994",
"BPL0303257496086",
"BPL0303257496086",
"BPL0303257496097",
"BPL0303257496097",
"BPL0303257496297",
"BPL0303257497596",
"BPL0203257493966",
"BPL0203257493966",
"BPL0603257507344",
"BPL0603257507344",
"BPL0403257498563",
"BPL0303257498396",
"BPL0303257498396",
"BPL0403257498563",
"BPL0303257498493",
"BPL0503257504595",
"BPL0303257496750",
"BPL0703257511703",
"BPL0303257498493",
"BPL0503257503935",
"BPL0503257503935",
"BPL0403257499186",
"BPL0403257499186",
"BPL0503257504595",
"BPL0603257507987",
"BPL0203257491670",
"BPL0203257491670",
"BPL0403257499449",
"BPL0403257499449",
"BPL0403257499444",
"BPL0503257504666",
"BPL0503257504666",
"BPL0403257499488",
"BPL0403257499488",
"BPL0403257499555",
"BPL0403257499555",
"BPL0603257507987",
"BPL0403257500429",
"BPL0403257500429",
"BPL0703257511703",
"BPL0703257513316",
"BPL0703257513316",
"BPL0503257504806",
"BPL0603257508324",
"BPL0603257508535",
"BPL0603257508324",
"BPL0603257508535",
"BPL0603257508715",
"BPL0603257508715",
"BPL0603257509079",
"BPL0603257509079",
"BPL0703257513687",
"BPL0703257513687",
"BPL0603257509333",
"BPL0503257504806",
"BPL0703257513299",
"BPL0603257509333",
"BPL0703257513299",
"BPL0703257512811",
"BPL0703257513640",
"BPL0703257513640",
"BPL0703257514324",
"BPL0703257514324",
"BPL0703257512811",
"BPL0403257502706",
"BPL0403257502706",
"BPL0303257498482",
"BPL0303257498482",
"BPL0603257509752",
"BPL0603257509752",
"BPL0603257510357",
"BPL0603257510394",
"BPL0603257510394",
"BPL0603257510412",
"BPL0603257510412",
"BPL0603257509207",
"BPL0603257509207",
"BPL0603257508075",
"BPL0603257508075",
"BPL0603257509090",
"BPL0603257509090",
"BPL0603257510848",
"BPL0603257510848",
"BPL0703257514726",
"BPL0703257514726"
]


for resourceId in resourceIds:
    event = next((c for c in failureEvents if c["resourceId"] == resourceId), None)
    if event == None:
        print(resourceId, "Not found skipping")
        continue
    delete(resourceId, event)