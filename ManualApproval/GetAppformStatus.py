import requests
from requests.auth import HTTPBasicAuth
from concurrent.futures import ThreadPoolExecutor, as_completed
import time

# Config Section
BASIC_AUTH_USERNAME = 'Un5GyOvnSbEw9Tf'  # replace with the username while running script
BASIC_AUTH_PSWD = 'eOk0c3Z87WmkujV'  # replace with the password while running script
fetch_appform_url = 'https://shield.creditsaison.in/api/v1/appForm/findByPartnerLoanId/{0}'

plid_list = [
"PRP8925331502",
"KSF_CRED_PROD_19054889",
"PRP7637639982",
"BPL0303257497622",
"BPL0303257497622",
"PRP9815086671",
"BPL0803257517143",
"MV256233154926",
"CASKB250205HPRXC",
"MV289912447764",
"MV289746820704",
"CASKB250129MCXDY",
"MV265042770531",
"BPL1503257540142",
"LAI1009746067",
"UNI8vfCo8rhiP1l5O6",
"CASKB250302PFSAR",
"CASKB250205KZTKN",
"CASKB250227AFSWG",
"CASKB250304JOOAA",
"CASKB250304XXHSF",
"CASKB250205HPRXC",
"CASKB250302AFIJK",
"CASKB250205YBDRN",
"CASKB250205KZTKN",
"KSF_CRED_PROD_15728260_185904560",
"LAI1009702835",
"LAI1009702850",
"1000823676",
"KSF_CRED_PROD_34304771_185903836",
"KSF_CRED_PROD_30222431_185905317",
"CASKB250307BUZJI",
"LAI1009702863",
"KSF_CRED_PROD_40364453_185905539",
"KSF_CRED_PROD_4760033_185905679",
"BPL0803257517143",
"CASKB250129CREEF",
"KSF_CRED_PROD_34934207_186190122",
"CASKB250129IVRYG",
"PRP0747871763",
"CASKB250309LWCLR",
"PRP5302797415",
"CASKB250129GNEFM",
"CASKB250129GNEFM",
"LAI1009754849",
"CASKB250129YDZGO",
"KSF_CRED_PROD_25436895",
"CASKB250129DHKMS",
"CASKB250129CREEF",
"CASKB250129IVRYG",
"CASKB250129DKDHW",
"CASKB250129CAMBT",
"KSF_CRED_PROD_3547190",
"CASKB250317HZSAF",
"BPL1603257547423",
"CASKB240710OSTAA",
"CASKB250129GVBKF",
"CASKB250317QKNWP",
"KSF_CRED_PROD_39388043",
"KSF_CRED_PROD_44032128",
"LAI1009715975",
"CASKB250129DDQQU",
"CASKB250129RRIWU",
"CASKB250129RJMMK",
"LAI1009703048",
"CASKB250129YDZGO",
"LAI1009703059",
"BPL0703257515267",
"BPL0703257515267",
"PRP6054061210",
"KSF_CRED_PROD_31170391",
"PRP8310060968",
"CASKB250129GVBKF",
"CASKB250129DHKMS",
"CASKB250129LDHQO",
"CASKB250129ZHTIN",
"PRP2524283481",
"KSF_CRED_PROD_35310703",
"CASKB250205YBDRN",
"CASKB250303YYXLU",
"KSF_CRED_PROD_19797583_185905193",
"KSF_CRED_PROD_8199059_185908578",
"CASKB250129CAMBT",
"MV271649673050",
"JPL3277bad5d37d433e80f2",
"CASKB250129ALNKB",
"CASKB250129DDQQU",
"BPL0503257504194",
"KSF_CRED_PROD_30643327",
"BPL1603257547423",
"PRP4957746994",
"PRP9622815863",
"PRP2472191097",
"CASKB250129SKGVS",
"BPL1503257542514",
"BPL1103257528215",
"KSF_CRED_PROD_866024",
"KSF_CRED_PROD_30178847",
"CASKB240710OSTAA",
"MV271871531466",
"MV293454986637",
"MV294790153406",
"MV283676423922",
"CASKB250129DKDHW",
"MV208334519789",
"MV287270275292",
"KSF_CRED_PROD_21497559",
"MV296157034934",
"MV295786138545",
"BPL1503257541837",
"BPL1503257541837",
"CASKB250129RRIWU",
"CASKB250129RJMMK",
"PLIaf00db36b965432cae0c170fe15cc1cb",
"KSF_CRED_PROD_10629169",
"PRP7598402585",
"BPL1103257528215",
"CASKB250312JAPDI",
"BPL1503257542017",
"MV257178539777",
"BPL1503257542982",
"BPL1503257542982",
"PRP2105370098",
"CASKB250129LDHQO",
"KSF_CRED_PROD_236406",
"PRP5693369523",
"KSF_CRED_PROD_36868896",
"KSF_CRED_PROD_23803019",
"MV265937841172",
"LAI1009734110",
"MV288116486432",
"BPL1203257533271",
"KSF_CRED_PROD_41803146",
"MV250860448798",
"BPL1703257547673",
"MV267476396115",
"BPL1503257542372",
"CASKB240710OSTAA",
"CASKB250129ZHTIN",
"CASKB250129SKGVS",
"BPL1203257533271",
"CASKB250205HPRXC",
"KSF_CRED_PROD_37879311",
"KSF_CRED_PROD_50477671",
"MV296040275671",
"CASKB250205KZTKN",
"CASKB250205YBDRN",
"CASKB250129YDZGO",
"MV234430044206",
"KSF_CRED_PROD_18881040",
"CASKB250129ALNKB",
"CASKB250129GNEFM",
"CASKB250129RRIWU",
"CASKB250129ZHTIN",
"CASKB250129LDHQO",
"CASKB250129ALNKB",
"KSF_CRED_PROD_25577547",
"CASKB250129MCXDY",
"CASKB250205KZTKN",
"CASKB250205YBDRN",
"KSF_CRED_PROD_30774430",
"CASKB250310EHBRK",
"KSF_CRED_PROD_34934207_186190122",
"CASKB250310KDADI",
"KSF_CRED_PROD_52707031",
"BPL1103257528861",
"CASKB250129GVBKF",
"CASKB250129IVRYG",
"CASKB250129CAMBT",
"CASKB250129DKDHW",
"CASKB250129DDQQU",
"CASKB250129DHKMS",
"CASKB250129CREEF",
"CASKB250129RJMMK",
"KSF_CRED_PROD_8505395",
"MV204095854452",
"BPL1703257550458",
"BPL1103257528861",
"PRP5125095905",
"PLI1529bfa0f5ee488fa8afe8b8250f01d2",
"MV285138855408",
"CASKB250129SKGVS",
"BPL0503257504194",
"BPL0803257516481",
"BPL0803257516481",
"KSF_CRED_PROD_20752191",
"1000824281",
"LAI1009748351",
"BPL1503257542990",
"BPL1703257549831",
"MV256450017780",
"MV295476094661",
"MV265717161172",
"MV273076362354",
"BPL1503257542514",
"MV294974770049",
"BPL1703257549831",
"KSF_CRED_PROD_55305242",
"CASKB250316EIJQA",
"PRP6807674041",
"MV264879842676",
"KSF_CRED_PROD_34707738",
"PRP4574117125",
"MV206830712836",
"CASKB250308KUCVJ",
"KSF_CRED_PROD_52016535",
"MV295558648138",
"MV293517889008",
"UNIMW7dti0HaXqnpK0",
"1000825050",
"MV221860343341",
"MV239356446790",
"KSF_CRED_PROD_19706872",
"PRP6436882418",
"MV241442658132",
"BPL0803257515651",
"PRP9542451964",
"BPL1003257524108",
"PRP1959346716",
"KSF_CRED_PROD_35399402",
"BPL1003257524108",
"MV234085657209",
"PRP8656727679",
"BPL1103257527034",
"PRP4713212906",
"PRP7996710065",
"MV283094426712",
"BPL0803257516149",
"BPL0803257516149",
"PRP4200973582",
"PSEKSF13275246",
"PRP8196715795",
"MV236555764052",
"KSF_CRED_PROD_547274_186685774",
"MV274802146166",
"LAI1009728174",
"MV231671784270",
"MV206402229185",
"MV208990061047",
"MV209189618663",
"MV263045213400",
"MV260242637577",
"MV254081365671",
"MV246859144751",
"PRP8005552684",
"MV266934454449",
"PRP7763648221",
"MV299514138730",
"MV266712131394",
"MV209654057226",
"MV207208638419",
"MV204962016844",
"MV270478253498",
"MV278142445003",
"BPL1703257550458",
"BPL1103257526053",
"KSF_CRED_PROD_30193372_186210802",
"BPL1103257526053",
"LAI1009726901",
"KSF_CRED_PROD_21448771",
"MV205589934097",
"MV296839088524",
"MV202646946641",
"MV203257654867",
"MV265399756506",
"BPL1103257526074",
"BPL0803257515763",
"JPL3277bad5d37d433e80f2",
"PRP1606590956",
"PRP3921788346",
"BPL0803257517994",
"BPL0803257517994",
"BPL1103257526074",
"BPL1103257527103",
"BPL1103257527103",
"MV209108169583",
"PRP2239350850",
"PRP8917386839",
"MV211624052303",
"KSF_CRED_PROD_51077264_186317123",
"BPL0803257515763",
"BPL0803257517795",
"BPL0803257517795",
"MV286043168427",
"PRP2925062296",
"BPL1103257526352",
"BPL1103257526352",
"KSF_CRED_PROD_17315467",
"KSF_CRED_PROD_2447103",
"PRP5431521955",
"LAI1009728174",
"PRP9620727894",
"MV294051273988",
"PRP0711434486",
"PRP4940168318",
"MV250553092520",
"KSF_CRED_PROD_2029387",
"BPL0103257490951",
"MV292078372962",
"MV298300824920",
"MV213500556909",
"MV281653985134",
"MV281031477292",
"KSF_CRED_PROD_41854315",
"KSF_CRED_PROD_4515873",
"KSF_CRED_PROD_38430396",
"PRP5415409166",
"MV297980855773",
"KSF_CRED_PROD_42347138",
"MV266785055235",
"KSF_CRED_PROD_12636041",
"MV270272845659",
"CASKB250311GAPIB",
"KSF_CRED_PROD_42286021",
"KSF_CRED_PROD_4627317",
"KSF_CRED_PROD_801045",
"MV290046051798",
"MV200456987603",
"BPL0803257516251",
"PRP3177485186",
"KSF_CRED_PROD_39423898",
"KSF_CRED_PROD_26603245",
"1000824390",
"PRP5175240328",
"KSF_CRED_PROD_28578988",
"BPL1103257526674",
"BPL1103257526674",
"CASKB250311AEDSA",
"MV217659735439",
"MV212547526223",
"MV211879691443",
"MV255693677675",
"MV284128628095",
"MV226763459524",
"BPL0803257516251",
"KSF_CRED_PROD_4308058",
"BPL1103257526890",
"KSF_CRED_PROD_9527517",
"MV215491243283",
"BPL1103257526890",
"MV208735651074",
"MV208597688912",
"MV208768816453",
"MV207949854711",
"MV298542662010",
"MV261787190109",
"MV299924399216",
"PRP3433212322",
"PRP9540165380",
"KSF_CRED_PROD_6117019",
"PRP4115242407",
"MV255847783859",
"MV256008151873",
"MV250925292676",
"BPL1003257522823",
"KSF_CRED_PROD_5603046",
"BPL1103257527034",
"BPL1703257548256",
"MV207966548929",
"MV220338280876",
"PRP2843315501",
"MV213160091292",
"JPL160e87a648844393bd37",
"CASKB250311RZQIN",
"MV299094315500",
"MV207724624488",
"KSF_CRED_PROD_30036277",
"MV263523478877",
"MV274209291834",
"BPL1703257548256",
"KSF_CRED_PROD_25414209",
"MV221258272511",
"MV249345090384",
"MV242537727795",
"BPL1003257522823",
"MV211231978447",
"BPL0803257516922",
"BPL0803257516949",
"BPL0803257516949",
"BPL0103257489758",
"BPL0103257489758",
"PRP1048278246",
"MV298804893121",
"KSF_CRED_PROD_24380750",
"KSF_CRED_PROD_14368944",
"MV204993443622",
"MV207275490447",
"BPL0803257516680",
"BPL0803257516680",
"PRP8890623643",
"KSF_CRED_PROD_21109331",
"MV208879166260",
"KSF_CRED_PROD_2943206",
"MV211715711468",
"BPL1103257527131",
"KSF_CRED_PROD_8943041",
"KSF_CRED_PROD_6250293",
"MV209833170996",
"MV200530927043",
"BPL1303257534124",
"BPL1303257534124",
"KSF_CRED_PROD_54114706",
"KSF_CRED_PROD_13755356",
"MV194252626542",
"MV201842728170",
"KSF_CRED_PROD_34347235",
"MV215243048337",
"KSF_CRED_PROD_40914072",
"KSF_CRED_PROD_3407672",
"KSF_CRED_PROD_19176182",
"KSF_CRED_PROD_3711385",
"MV212599165817",
"MV202671013228",
"BPL1703257548339",
"KSF_CRED_PROD_33937585",
"1000822123",
"1000824389",
"KSF_CRED_PROD_9369422_186779508",
"KSF_CRED_PROD_17578680",
"BPL1703257548339",
"MV215510615472",
"1000820041",
"BPL0803257516794",
"BPL0803257516794",
"KSF_CRED_PROD_5707907",
"KSF_CRED_PROD_5066000",
"KSF_CRED_PROD_20449395",
"KSF_CRED_PROD_17840792",
"BPL1303257534444",
"KSF_CRED_PROD_24819609",
"BPL0803257516858",
"UNIHqhND8iileuQQ0N",
"BPL0803257516858",
"CASKB250310KUJOO",
"KSF_CRED_PROD_40588946",
"PRP6192621931",
"PRP9308058886",
"KSF_CRED_PROD_41986026",
"MV211174631358",
"KSF_CRED_PROD_16582438",
"LAI1009729644",
"BPL1703257548374",
"MV298623862189",
"1000824391",
"BPL1503257543759",
"BPL1503257543759",
"BPL0803257516922",
"PRP3248374641",
"KSF_CRED_PROD_38537337",
"MV215383822228",
"KSF_CRED_PROD_18607211",
"BPL1003257523542",
"BPL1003257523542",
"BPL1003257523613",
"CASKB250311QSTGL",
"MV216223979766",
"MV214851514995",
"MV256618143298",
"MV257702699759",
"MV216156024254",
"BPL1603257544158",
"BPL0803257515857",
"BPL0803257515857",
"MV224461422752",
"KSF_CRED_PROD_39736442",
"BPL1003257523613",
"BPL1703257548374",
"PRP0950321397",
"KSF_CRED_PROD_51821979",
"MV240260772359",
"MV263263974907",
"MV262398911657",
"PRP9217885671",
"KSF_CRED_PROD_4729310_186397543",
"PRP2394100005",
"LAI1009729777",
"MV258314162206",
"PRP8288503459",
"MV249078352822",
"PRP4690342659",
"BPL1703257549023",
"BPL1703257549023",
"PRP1394565947",
"MV217266299194",
"MV262049734917",
"MV236097493249",
"MV227878884697",
"MV228985981385",
"MV216645613915",
"1000823854",
"KSF_CRED_PROD_6264458",
"KSF_CRED_PROD_8764908",
"PRP4652483785",
"MV251356963117",
"1443010794",
"CASKB250311GAPIB",
"CASKB250311QSTGL",
"MV261493533660",
"MV233468642394",
"MV227296024202",
"KSF_CRED_PROD_15901409",
"CASKB250316ONXQP",
"BPL1503257540888",
"PRP6301327808",
"KSF_CRED_PROD_2968106",
"MV219035781724",
"KSF_CRED_PROD_28354733",
"BPL1003257523411",
"KSF_CRED_PROD_7702288",
"KSF_CRED_PROD_28452761",
"KSF_CRED_PROD_13327196_186699830",
"MV258295630035",
"MV220971369747",
"MV263009056687",
"PRP4593990619",
"BPL1603257544656",
"MV252393240066",
"CASKB250318XRWPN",
"KSF_CRED_PROD_51705378",
"KSF_CRED_PROD_40874576",
"KSF_CRED_PROD_4409071",
"BPL1003257523411",
"MV219613981101",
"BPL1703257551710",
"BPL0903257519385",
"KSF_CRED_PROD_13327196_186699830",
"KSF_CRED_PROD_14621976",
"BPL1703257551710",
"PRP5347733391",
"BPL1603257544656",
"PRP7587165405",
"MV264950374345",
"BPL1303257534444",
"CASKB250317GNMCM",
"KSF_CRED_PROD_54974346",
"MV201365434377",
"KSF_CRED_PROD_26774057",
"PRP4052082274",
"MV222965948899",
"CASKB250317WMDCZ",
"BPL1603257544125",
"KSF_CRED_PROD_23127392",
"BPL1603257544851",
"BPL1603257544851",
"BPL1503257540888",
"KSF_CRED_PROD_33553053",
"KSF_CRED_PROD_47448016",
"PRP9492674591",
"BPL1303257534400",
"KSF_CRED_PROD_23475444",
"KSF_CRED_PROD_3303908",
"CASKB250313KCGPK",
"MV226910312200",
"MV207882810177",
"MV220082153144",
"BPL1303257534400",
"PRP3485453501",
"KSF_CRED_PROD_40191463",
"LAI1009717099",
"CASKB250313YDNWW",
"MV262815468647",
"PRP9861826218",
"BPL1603257544125",
"MV295637192855",
"MV227216872352",
"CASKB250317HZSAF",
"MV267744170681",
"PRP7568974130",
"MV247972373271",
"BPL0903257519385",
"PRP3539890837",
"BPL1703257549224",
"MV251968422316",
"MV246184483967",
"KSF_CRED_PROD_34179238",
"PSEKSF13273822",
"PRP4280442752",
"MV261450737782",
"KSF_CRED_PROD_21631296_178457573",
"JPL9a81012b20324e1f8cd3",
"MV250377693440",
"MV263316645862",
"MV263344773581",
"MV246367930047",
"KSF_CRED_PROD_23253378",
"KSF_CRED_PROD_3138318",
"PRP8835726926",
"MV260667475986",
"BPL1003257524454",
"MV264210876309",
"1000822126",
"1000822125",
"MV231426034851",
"1450081251",
"KSF_CRED_PROD_3366398",
"PRP9112970350",
"OLATL170936731R1",
"BPL1003257522210",
"MV249047894000",
"MV249547962406",
"KSF_CRED_PROD_30357934",
"MV259044540262",
"MV249486695411",
"MV245885485790",
"PRP7915556853",
"MV251125580908",
"MV296385862553",
"MV250677569455",
"MV249165725278",
"MV265759162394",
"MV201813716906",
"MV277332826776",
"MV259672659599",
"PRP8688888412",
"KSF_CRED_PROD_13040176",
"MV286613866452",
"MV204673168704",
"1000822124",
"KSF_CRED_PROD_9353824",
"CASKB250316EIJQA",
"LAI1009750554",
"1000822262",
"BPL1603257545211",
"KSF_CRED_PROD_29845611",
"MV228424654653",
"1450081251",
"MV255614199971",
"MV247594978360",
"MV202819762552",
"MV299965076319",
"MV224315187273",
"MV272956020973",
"BPL1003257524516",
"BPL1003257524516",
"PRP5540092689",
"PRP0160232505",
"MV251788192248",
"PRP1851092234",
"MV248720115071",
"BPL1603257544158",
"BPL1603257544650",
"BPL1603257544650",
"BPL1603257545008",
"BPL1603257545008",
"CASKB250316ELPAM",
"KSF_CRED_PROD_24217192",
"PRP4916780117",
"KSF_CRED_PROD_4448738",
"KSF_CRED_PROD_14634293",
"MV291178440509",
"MV203580081531",
"MV230531646664",
"BPL1003257524454",
"PRP9638282099",
"1000821970",
"BPL1703257549326",
"MV259533572380",
"MV232485083324",
"LAI1009761687",
"CASKB250309IDQQT",
"MV298448691577",
"CASKB250309BPRZT",
"CASKB250309GYJGE",
"CASKB250309QCJTO",
"CASKB250309YOGBP",
"CASKB250309ARPGH",
"MV205494017729",
"MV202993129393",
"UNI2aGUjJJJ5KImVuO",
"KSF_CRED_PROD_9705242",
"MV200371376638",
"LAI1009730975",
"PRP1823772732",
"CASKB250309YPQME",
"CASKB250309SHJFC",
"KSF_CRED_PROD_44503152",
"KSF_CRED_PROD_23803107",
"MV283718396669",
"UNISfK2yNDQmgKM7kg",
"MV210477029584",
"MV230915993660",
"MV231680657064",
"MV210194978197",
"MV235735290508",
"MV234808013777",
"CASKB250313JMWSY",
"CASKB250313BQQQL",
"BPL0903257519268",
"BPL0903257519268",
"KSF_CRED_PROD_2261448_186123136",
"CASKB250313WIGKJ",
"KSF_CRED_PROD_41578909",
"MV207696192001",
"MV206670713302",
"KSF_CRED_PROD_660607",
"MV250708259721",
"MV250949961641",
"MV250375091303",
"BPL1603257545050",
"CASKB250316WUTMA",
"KSF_CRED_PROD_7319608",
"KSF_CRED_PROD_25167944",
"CASKB250313LAXYQ",
"LAI1009719710",
"MV237662010244",
"PRP8882891444",
"1000822128",
"JPL9a81012b20324e1f8cd3",
"1000822087",
"1000822089",
"KSF_CRED_PROD_13171790",
"1000822091",
"BPL1603257545150",
"BPL1603257545150",
"MV231590862020",
"MV226402850166",
"BPL1803257552718",
"MV279955050718",
"BPL2802257484621",
"PRP6443961628",
"KSF_CRED_PROD_32499145",
"PRP5652690075",
"KSF_CRED_PROD_32637644",
"MV247531976625",
"MV248517559677",
"BPL1703257549326",
"CASKB250313ZAFVX",
"BPL1703257549286",
"BPL1603257545211",
"1000822157",
"KSF_CRED_PROD_12381434",
"MV272983048282",
"MV286763548662",
"KSF_CRED_PROD_23803107",
"CASKB250317QKNWP",
"MV232834097430",
"KSF_CRED_PROD_54395167",
"MV288612361572",
"CASKB250313ZAFVX",
"CASKB250316LANZW",
"BPL1803257552412",
"LAI1009751957",
"BPL1803257552412",
"1000822143",
"KSF_CRED_PROD_23137861",
"MV287407666408",
"MV201783821071",
"MV265425596674",
"MV202543962577",
"KSF_CRED_PROD_17368300_186122263",
"MV201721685982",
"MV282825381654",
"BPL1203257530721",
"1000822180",
"MV221819734324",
"MV261602627032",
"MV251788192248",
"BPL1603257545617",
"KSF_CRED_PROD_10370654",
"KSF_CRED_PROD_19309555",
"PRP9978590472",
"MV251482773124",
"MV220062430952",
"1000822185",
"MV244163653724",
"MV251882630344",
"MV248642795558",
"1000822190",
"1000822200",
"MV246732315035",
"MV250027213517",
"MV249888184069",
"MV246848723230",
"MV250245343821",
"MV250515722001",
"MV251251162457",
"MV246950075205",
"MV251381926353",
"BPL1203257530721",
"MV267431544653",
"PRP6508574392",
"MV249962896585",
"MV247950150982",
"BPL1303257535666",
"CASKB250313YCPJB",
"1000821971",
"CASKB250313EOEHO",
"CASKB250313NTZOO",
"1000822132",
"MV255249368544",
"BPL1603257545617",
"BPL1603257545618",
"PRP3170314267",
"MV248331443353",
"KSF_CRED_PROD_29361794",
"MV225660953695",
"CASKB250313ZAFVX",
"CASKB250313LAXYQ",
"KSF_CRED_PROD_55879626",
"PRP4955729328",
"KSF_CRED_PROD_54275220_186448171",
"CASKB250313YDNWW",
"1000821992",
"BPL1303257535666",
"CASKB250313SHKWD",
"1000822134",
"1000822136",
"1000822133",
"CASKB250313NHBYG",
"1000822138",
"CASKB250313NGWCS",
"CASKB250313ASNXJ",
"PRP1067989263",
"PRP7098512851",
"MV205337856613",
"1000821972",
"1000821977",
"MV292861890489",
"PRP7124844549",
"MV271618277414",
"MV263217060044",
"1000822098",
"MV262706422742",
"MV270946688337",
"1000822097",
"KSF_CRED_PROD_7302548",
"1000822100",
"BPL1603257545618",
"KSF_CRED_PROD_23647089",
"1000821975",
"CASKB250313KQIBP",
"PRP6866372319",
"1000822135",
"MV209389753697",
"CASKB250313MDBPA",
"1000821994",
"1000821997",
"1000822002",
"1000822003",
"CASKB250313FHWEE",
"CASKB250316TXTYY",
"CASKB250309AVIPN",
"PLIc164a1e79bc6497b8072dd68698b10e7",
"PRP7586474515",
"MV220302673809",
"LAI1009731992",
"MV231061111385",
"MV265387610777",
"BPL1003257525236",
"1000822093",
"KSF_CRED_PROD_21563018_186435916",
"KSF_CRED_PROD_25150547_186435970",
"CASKB250312EGAYH",
"PRP9970887106",
"BPL1803257552231",
"PRP1838119263",
"PRP0585314836",
"KSF_CRED_PROD_45950362",
"BPL1203257531419",
"BPL1803257552231",
"CASKB250318UQBGQ",
"PRP0846085906",
"MV233363587301",
"BPL0903257521171",
"BPL0903257521171",
"CASKB250312JRVHL",
"1000821976",
"MV235566113372",
"1000822140",
"1000822088",
"MV235059365142",
"MV241132377382",
"MV271884026826",
"MV262700555779",
"BPL1203257531419",
"BPL1603257546687",
"BPL1603257546687",
"CASKB250318UQBGQ",
"CASKB250312JRVHL",
"KSF_CRED_PROD_18934824",
"1000822095",
"1000822145",
"CASKB250316EWQTJ",
"MV284132261612",
"MV223487522132",
"BPL1803257552718",
"1000822092",
"1000822090",
"MV271372623859",
"MV261062088044",
"MV271795693069",
"MV265088781765",
"PRP2243751933",
"PLI816db85f35b04d7ca5d676b573dd96ed",
"CASKB250316EWQTJ",
"KSF_CRED_PROD_22151345",
"CASKB250313RIMTW",
"MV203558422912",
"BPL1603257544337",
"CASKB250313BTYNR",
"CASKB250313PQOXF",
"KSF_CRED_PROD_2341842_186449992",
"1000821983",
"CASKB250312QLJFH",
"1000821988",
"1000821987",
"1000822005",
"CASKB250313CMZVL",
"CASKB250313EEEFF",
"CASKB250313TBQTC",
"1000822178",
"1000822096",
"1000821978",
"1000821982",
"KSF_CRED_PROD_54289963",
"CASKB250313ZRYVS",
"1000822146",
"BPL1603257544337",
"1000822151",
"CASKB250312EGAYH",
"1000822147",
"CASKB250313GPXGT",
"1000822148",
"KSF_CRED_PROD_11108791",
"CASKB250313VGSMQ",
"CASKB250313SOIJS",
"1000821979",
"PRP3168420067",
"BPL1003257525236",
"1000821995",
"1000822004",
"KSF_CRED_PROD_13522198",
"UNIGbnmHcGffkJT9vN",
"1000822016",
"1000822018",
"BPL1303257536734",
"BPL1303257536734",
"1000822153",
"KSF_CRED_PROD_16770375",
"1000822183",
"1000822186",
"1000822187",
"KSF_CRED_PROD_18240898",
"CASKB250309ZSLRQ",
"MV210994594518",
"MV221118595516",
"1000821980",
"PRP0106561012",
"PRP4460723234",
"KSF_CRED_PROD_15574333",
"1000822102",
"1000821990",
"1000821989",
"BPL1603257544142",
"1000822024",
"1000822101",
"BPL1603257544142",
"1000822103",
"1000822154",
"1000822158",
"1000821986",
"1000821998",
"KSF_CRED_PROD_17337487",
"LAI1009714233",
"BPL1303257536225",
"BPL1303257536225",
"1000821999",
"1000822017",
"1000822014",
"1000822104",
"1000822105",
"1000822107",
"BPL1603257547206",
"1000822155",
"1000822156",
"1000822201",
"PRP5808718492",
"1000822008",
"OLATL5915676R1",
"UNIqfwetHeCv9LkaAX",
"1000822117",
"1000822006",
"LL_CRED_PROD_12324800",
"KSF_CRED_PROD_27522358",
"UNIalKzZnSxkcQzbGW",
"KSF_CRED_PROD_45170657",
"1000822021",
"PRP5946204063",
"1000822106",
"1000822189",
"UNIqasKVFlDZCeuUZV",
"1000822188",
"1000822191",
"1000822194",
"CASKB250305ZREUS",
"1000822010",
"1000822020",
"1000822023",
"PRP5093938708",
"BPL1603257547206"
"PRP0787414606",
"CASKB250305ODUGN",
"1000822011",
"CASKB250227AFSWG",
"MV251788192248",
"1000822009",
"1000822013",
"1000822108",
"1000822109",
"1000822111",
"CASKB250205YBDRN",
"CASKB250205KZTKN",
"MV280200920072",
"MV284524714993",
"1000822031",
"1000822029",
"1000822027",
"1000822116",
"CASKB250227AFSWG",
"CASKB250316AWXYN",
"KSF_CRED_PROD_2611288",
"MV245207221716",
"1000822115",
"KSF_CRED_PROD_49676197_186179160",
"1000822191",
"KSF_CRED_PROD_54434201",
"MV222485846604",
"MV218170537648",
"MV172715711383",
"CASKB250205KZTKN",
"CASKB250205YBDRN",
"1000822113",
"KSF_CRED_PROD_49676197_186179160",
"MV283925083170",
"1000822030",
"1000822032",
"BPL1303257536593",
"MV250176543348",
"1000822179",
"1000822182",
"1000822181",
"1000822197",
"1000822199",
"BPL1303257537061",
"BPL1303257537061",
"MV280481152124",
"1000822196",
"MV245121362278",
"MV212375084843",
"LAI1009742327",
"1000822033",
"MV283091723382",
"PRP9767105166",
"1000822035",
"PSEKSF13285651",
"1000822202",
"PRP7849925472",
"MV283089192696",
"1000822034",
"UNIIAt7l4LJiJAuB1X",
"MV293932233475",
"BPL1203257532353",
"BPL1203257532353",
"1000822336",
"MV279659719845",
"MV246973169795",
"BPL1403257537753",
"BPL1403257537753",
"1000822119",
"1000822118",
"KSF_CRED_PROD_10901055_186554984",
"PRP2420330981",
"MV288746615416",
"1000822206",
"MV284433869297",
"MV285540179773",
"MV232458089839",
"MV281311971464",
"MV257437424225",
"MV261382724935",
"MV211211532450",
"MV248014163959",
"MV204621018384",
"MV266953895182",
"MV288822872197",
"1000822043",
"MV294340942904",
"MV247563872311",
"MV286014232157",
"MV206252965720",
"MV290799788984",
"1000822044",
"MV262273824653",
"1000822120",
"MV291127442746",
"KSF_CRED_PROD_21334036_186571434",
"1000822039",
"1000822042",
"1000822040",
"1000822207",
"BPL1403257537721",
"1000822121",
"1000822047",
"1000822037",
"CASKB250314LSLWS",
"CASKB250314LSLWS",
"1000822045",
"UNIDH1ivbp0ByjYv6n",
"MV215842823974",
"UNIfvMGmUs4yhNQgGi",
"LAI1009719001",
"BPL1403257538672",
"MV226199761711",
"UNI8vfCo8rhiP1l5O6",
"LAI1009698168",
"1000822050",
"BPL1403257538335",
"BPL1403257538335",
"1000822257",
"1000822191",
"1000822049",
"LAI1009742284",
"1000822062",
"1000822064",
"1000822061",
"BPL1403257539470",
"CASKB250302PFSAR",
"1000824768",
"CASKB250314EDQAX",
"CASKB250314RXZNE",
"CASKB250314TOHZT",
"PRP9536314887",
"1000822056",
"1000822057",
"1000822059",
"CASKB250302AFIJK",
"1000822058",
"KSF_CRED_PROD_20516602",
"JPL2ac1c82ed547420fb4a5",
"BPL1403257538672",
"BPL1403257538724",
"BPL1403257538724",
"PRP6342844603",
"MV238463075797",
"CASKB250302AFIJK",
"BPL1403257538668",
"BPL1403257539067",
"CASKB250302PFSAR",
"BPL1403257539172",
"BPL1403257539172",
"CASKB250314IMZFK",
"BPL1403257538668",
"BPL1403257539100",
"BPL1403257539100",
"KSF_CRED_PROD_44944132",
"KSF_CRED_PROD_45834778",
"PRP5723451472",
"BPL1403257539067",
"CASKB250303YYXLU",
"LAI1009742284",
"BPL1303257533906",
"BPL1303257533906",
"PRP9055155456",
"BPL1403257539215",
"PRP1769156950",
"BPL1403257539215",
"BPL1403257539470",
"KSF_CRED_PROD_55873297",
"LAI1009688669",
"LAI1009688669",
"UNI2gNW9eYKmc0l8YY",
"BPL1403257539478",
"BPL1403257539478",
"LAI1009689109",
"PRP4763414340",
"KSF_CRED_PROD_13699961",
"MV250057369223",
"MV267314335815",
"MV248075550869",
"MV279759919742",
"BPL1403257539806",
"CASKB250303YYXLU",
"MV291438448966",
"KSF_CRED_PROD_7036185_186628430",
"LAI1009745546",
"JPLd7833ba6a6c0482c9b59",
"BPL1403257539672",
"MV272041932633",
"MV277074588307",
"BPL1403257539672",
"CASKB250304JOOAA",
"CASKB250304JOOAA",
"MV268805948224",
"MV269995887856",
"AVNKSF55100127842335",
"LAI1009694703",
"MV275125027249",
"MV288287964780",
"BPL1403257539782",
"MV270072125772",
"MV250376773682",
"BPL1403257539782",
"AVNKSF55100128196574",
"MV260948990001",
"MV267329393100",
"MV267243096709",
"1000822073",
"1000822082",
"1000822072",
"1000822080",
"1000822067",
"1000822086",
"1000822066",
"1000822075",
"1000822083",
"1000822071",
"1000822085",
"1000822068",
"1000822084",
"1000822074",
"1000822079",
"1000822150",
"CASKB250304XXHSF",
"LAI1009745204",
"CASKB250304XXHSF",
"MV270527458240",
"MV269392427550",
"PSEKSF13205085",
"MV263659683036",
"MV281812133992",
"KSF_CRED_PROD_11958900",
"BPL1403257539806",
"KSF_CRED_PROD_8474669",
"KSF_CRED_PROD_32512002",
"BPL1403257539175",
"BPL1403257539175",
"CASKB250315UZBSW",
"MV247520419532",
"BPL1503257540735",
"BPL1503257540735",
"1462452909",
"MV279742925881",
"MV247113268169",
"BPL1403257539726",
"BPL1403257539726",
"MV210511362985",
"BPL1503257540321",
"BPL1503257540321",
"BPL1503257540427",
"BPL1503257540427",
"JPLd7833ba6a6c0482c9b59",
"KSF_CRED_PROD_5202694",
"KSF_CRED_PROD_30532199",
"LAI1009681732",
"KSF_CRED_PROD_12278877",
"BPL1503257541212",
"BPL1503257541212",
"KSF_CRED_PROD_4263861",
"KSF_CRED_PROD_30250632",
"KSF_CRED_SET3_124427",
"KSF_CRED_PROD_2972146",
"BPL1503257542017",
"KSF_CRED_PROD_3707390",
"KSF_CRED_PROD_2714268",
"PRP0256498334",
"BPL1503257542372",
"BPL1503257542990",
"KSF_CRED_PROD_13513664",
"KSF_CRED_PROD_21167214",
"BPL1503257540142",
"PRP8623346537",
"PRP1716882294",
"PRP1970467735",
"KSF_CRED_SET3_77463",
"KSF_CRED_PROD_29129779",
"KSF_CRED_PROD_11723192",
"MV222931746352",
"CASKB250315XDYQR",
"MV253205212031",
"MV254365067750",
"MV274461216966",
"KSF_CRED_PROD_15797987",
"KSF_CRED_PROD_21934428",
"CASKB250315RQTAD",
"PSEKSF13290438",
"LAI1009748755"

]

print("Fetching data. Please wait...")

credit_complete_list = []
qc_in_progress_list = []
disbursal_complete_list = []
credit_in_progress_list = []
disbursal_in_progress_list = []
qc_complete_list = []
rejected_list = []  # List to store rejected applications

# Retry decorator
def retry(retries=3, backoff_factor=0.3):
    def decorator_retry(func):
        def wrapper_retry(*args, **kwargs):
            max_retries, delay = retries, backoff_factor
            for attempt in range(1, max_retries + 1):
                try:
                    return func(*args, **kwargs)
                except requests.exceptions.RequestException as e:
                    if attempt == max_retries:
                        raise
                    time.sleep(delay * 2 ** (attempt - 1))
        return wrapper_retry
    return decorator_retry

@retry(retries=3, backoff_factor=0.3)
def fetch_status(plid):
    try:
        response_get = requests.get(fetch_appform_url.format(plid), auth=HTTPBasicAuth(BASIC_AUTH_USERNAME, BASIC_AUTH_PSWD), verify=False)
        response_get.raise_for_status()
        json_response = response_get.json()
        return json_response.get('status'), json_response.get('appFormStatus'), plid
    except requests.exceptions.SSLError:
        print(f"SSL verification failed for PLID: {plid}. Retrying with Verify=False...")
        # Retry with Verify=False if SSL verification fails
        response_get = requests.get(fetch_appform_url.format(plid), auth=HTTPBasicAuth(BASIC_AUTH_USERNAME, BASIC_AUTH_PSWD), verify=False)
        response_get.raise_for_status()
        json_response = response_get.json()
        return json_response.get('status'), json_response.get('appFormStatus'), plid

def process_status(status, appFormStatus, plid):
    if status:
        if status == "CREDIT_COMPLETE":
            credit_complete_list.append(plid)
        elif status == "QC_IN_PROGRESS":
            qc_in_progress_list.append(plid)
        elif status == "DISBURSAL_COMPLETE":
            disbursal_complete_list.append(plid)
        elif status == "CREDIT_IN_PROGRESS":
            credit_in_progress_list.append(plid)
        elif status == "DISBURSAL_IN_PROGRESS":
            disbursal_in_progress_list.append(plid)
        elif status == "QC_COMPLETE":
            qc_complete_list.append(plid)
    elif appFormStatus == "-20":  # Check for rejected applications
        rejected_list.append(plid)
    else:
        print(f"Status not found for PLID: {plid}")

# Using ThreadPoolExecutor for parallel requests
with ThreadPoolExecutor(max_workers=10) as executor:
    future_to_plid = {executor.submit(fetch_status, plid): plid for plid in plid_list}
    for future in as_completed(future_to_plid):
        plid = future_to_plid[future]
        try:
            status, appFormStatus, plid = future.result()
            process_status(status, appFormStatus, plid)
        except Exception as e:
            print(f"An error occurred while fetching data for PLID {plid}: {e}")

# Write results to file
with open('results.txt', 'w') as f:
    f.write("CREDIT_COMPLETE List:\n")
    f.write("\n".join(credit_complete_list) + "\n")
    f.write("\nQC_IN_PROGRESS List:\n")
    f.write("\n".join(qc_in_progress_list) + "\n")
    f.write("\nDISBURSAL_COMPLETE List:\n")
    f.write("\n".join(disbursal_complete_list) + "\n")
    f.write("\nCREDIT_IN_PROGRESS List:\n")
    f.write("\n".join(credit_in_progress_list) + "\n")
    f.write("\nDISBURSAL_IN_PROGRESS List:\n")
    f.write("\n".join(disbursal_in_progress_list) + "\n")
    f.write("\nQC_COMPLETE List:\n")
    f.write("\n".join(qc_complete_list) + "\n")
    f.write("\nREJECTED List:\n")  # Add a section for rejected applications
    f.write("\n".join(rejected_list) + "\n")  # Write rejected application IDs

print("Results written to results.txt")